<html>
<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
	
	<!--FONT SECTION-->
	
	<link href="https://fonts.googleapis.com/css?family=Pacifico" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Rock+Salt" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Euphoria+Script" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Bangers" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Yesteryear" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Nova+Flat" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Dancing+Script" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Oswald:300" rel="stylesheet">

	<meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline'; style-src 'self' 'unsafe-inline'; media-src *" />
    
	<!--Attached CSS-->
	<link rel="stylesheet" type="text/css" href="css/index.css" />
	<link rel="stylesheet" type="text/css" href="css/login_button.css" />
	<link rel="stylesheet" type="text/css" href="css/signup_button.css" />
	<link rel="stylesheet" type="text/css" href="css/menu_cards.css" />
	<title>SquareOne Feedback</title>
</head>
<body>

	<script src="js/jQuery.js">
	</script>
	<script src="js/mailgun_validator.js"></script>
		<div id='welcome_screen' class='splash'>
				
		</div>

		<div class='welcome_buttons' id='welcome_b'>
			Get Started
		</div>
	<script>

			jQuery('div#welcome_b').animate(
						{
							opacity: 0.8
						},2500,function(){});
	</script>
	<script>
			jQuery('.splash').animate(
			{
			opacity:0.8,
			},1000,function(){});
	jQuery('div#welcome_b').on('touchend click', function()
		{
			jQuery('div#welcome_screen').hide();
			jQuery('div#welcome_you').hide();
			jQuery('div#welcome_b').hide();
			jQuery('div#login_page').show(1000,function(){});
			jQuery('body').css('background' , ' #000 url(img/background.jpg) no-repeat center');
			jQuery('p#about_us').animate({'fontSize':'10px','marginTop': '5px'},1000,function(){jQuery('div#foot_back').removeAttr('id')});
		}
		);
	</script>

    <div id='login_page' class='app'>
	
		<table align='center'>
		<tr><td><input type='text' class='login_input_text' id='unme' placeholder='Username'></td></tr>
		<tr><td><input type='password' class='login_input_text' id='pass' placeholder='Password'></td></tr>
		<tr><td><button class='login_button' id='main_login'><b>Login</b></button></td></tr>
		<tr><td><p align='center' id='forget_password' style='font-size:13px;'>Forget Password?</p></td></tr>
		<tr><td><br><center><img src='img/or.png'></center><br></td></tr>
		<tr><td><button class='login_button' id='fb_login'><b>Login with Facebook</b></button></td></tr>
		<tr><td><button class='login_button' id='g_login'><b>Sign in with Google</b></button><br><br></td></tr>
		<tr><td><p align='center' id='sign' style='font-size:13px;'>Not a user ? Sign Up</p></td></tr>
		</table>
		
	</div>

	
	
	<div id='sign_page' class='signup'>		
		<table align='center'>
			<tr><td><input type="text" class='signup_input' id="name" placeholder="Name"></td></tr><br>
			<tr><td><input type="text" class='signup_input' id="sign_name" placeholder="Username"></td></tr><br>
			<tr><td><input type="email" id="Xmail" class='signup_input' placeholder="E-mail"></td></tr><br>
			<tr><td><input type="password" class='signup_input' id="s_pass" placeholder="Password"></td></tr><br>
			<tr><td><input type="password" class='signup_input' id="s_pass1" placeholder="Confirm Password"></td></tr><br>
			<tr><td colspan=2><input type="checkbox" name='trms' id='terms' unchecked> I accept the terms and conditions*<br></td></tr><br>
			<tr></tr><tr></tr>
			<tr align='center'><td><button class='signup_button' id='b_signup'>Sign Up</button>
									<button  class='signup_button' id='b_signupcancel'>Back</button></td></tr>
			<tr><td><div id="X_ALERT" class="alert">
			<span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
			<span align='center'  id="statusX"></span></div></td></tr>
		</table>
	</div>	
		<div class='head_main'>SquareOne Feedback
	</div>
	<div class='main_ui'>
	<table id='nav_buttons' cellpadding='10%'  class='main_ui_button_space'>
		<tr>
			<td class='main_buttons_td' id='menu_button1' colspan='2' ><center><img height='110px' width='110px' src='img/menu.png'></center></td>
		</tr>
		<tr>
			<td class='main_buttons_td' id='menu_button2' colspan='2'><center><img height='110px' width='110px' src='img/suggestion.png'></center></td>
		</tr>
		<tr>
			<td class='main_buttons_td' id='menu_button3'><center><img height='110px' width='110px' src='img/complaint.png'></center></td> <td class='main_buttons_td'><img height='110px' width='110px' src='img/menu.png'></td>
		</tr>
	</table>
	</div>
	<div class='menu_card_ui'>
	<div id='menu_card'></div>
	<div id='feedbackUI'></div>
	<div id="FEEDBACKMAIN"></div>
	</div>
	
	<div class='foot'>
		<div id='foot_back'>
			<hr id='foot_hr'>
			<p id='about_us'><b>About Us</b></p>
		</div>
	</div>

	<div class='foot_main'>
		<div id='foot_buttons'>
		<center>
		<ul id='inline_ul_foot'>
		<li class='main_foot_li' id='main_foot_li_L'><div class='main_ui_foot_buttons' id='name_display_foot'></div></li>
		<li class='main_foot_li' id='main_foot_li_AboutUS'><div class='main_ui_foot_buttons'>About Us</div></li>
		</ul></center>
		</div>
	</div>

	<script>
		jQuery('#main_login').on("touchend", function()
		{
		var name_x=(jQuery("input:text#unme").val().toLowerCase());
		var pass=(jQuery("input[type=password]#pass").val());
		var data_login="name="+name_x+"&password="+pass;
		if(name_x==''&&pass=='')
		alert('Please Enter the details');
		else{
			jQuery.ajax({
			type: "POST",
			url:'http://www.squareonefeedback.com/Scripts/login.php',
			data: data_login,
			crossDomain: true,
			cache: false,
			success: function(data){
				if(data=="dummy")
				{
				alert('User does not exists');
				alert('Please SignUp');
				}
				else
				{
					login_fun(data,name_x);
				}
			}
			});}
		return false;
		});
		jQuery('p#sign').on('touchend', function()
		{				
			jQuery('div#login_page').hide(1000,function(){});
			jQuery('div#sign_page').show(1000,function(){});
			jQuery('input:text.signup_input').val('');
		});		
	jQuery('button#b_signup').on('touchend', function()
	{
		var Xname=(jQuery('#name').val());
		var Xuname=(jQuery('#sign_name').val());
		var Xemail=(jQuery('#Xmail').val());
		var Xpass=(jQuery("input[type=password]#s_pass").val());
		var Xpass2=(jQuery("input[type=password]#s_pass1").val());
		if(Xname!=''&&Xuname!=''&&Xemail!=''&&Xpass!=''&&Xpass2!='')
		{	
			
			if(jQuery("#terms").is(":checked"))
				{
					if(Xpass==Xpass2)
					{
						jQuery('div#X_ALERT').show(500,function(){});
						var data_send="name="+(jQuery('#name').val())+"&username="+(jQuery('#sign_name').val().toLowerCase())+"&email="+(jQuery('#Xmail').val())+"&password="+(jQuery("input[type=password]#s_pass").val());
						jQuery.ajax({
						type: "POST",
						url:'http://www.squareonefeedback.com/Scripts/signup.php',
						data: data_send,
						crossDomain: true,
						cache: false,
						success: function(data)
						{
						jQuery('#statusX').text(data);
						},
						failure:function()
						{
						jQuery('#statusX').text('Not Done');
						},
						beforeSend: function(data)
						{
						jQuery('#statusX').text('In Progress');
						jQuery('#statusX').text('In Progress.');
						jQuery('#statusX').text('In Progress..');
						jQuery('#statusX').text('In Progress');
						jQuery('#statusX').text('In Progress.');
						jQuery('#statusX').text('In Progress..');
						}
						});
						
					}
					else{jQuery('div#X_ALERT').show(500,function(){jQuery('#statusX').text("Password does not match");});
					}
				}
				else
				{jQuery('div#X_ALERT').show(500,function(){jQuery('#statusX').text("Please accept terms and conditions.");});}
		}else{jQuery('div#X_ALERT').show(500,function(){jQuery('#statusX').text("Please Enter Full Details");});}
		return false;
	});
		jQuery('p#forget_password').on("touchend", function()
		{
			alert('Contact us at support@squareonefeedback.com');
		});
		jQuery('button#b_signupcancel').on("touchend", function()
		{
			jQuery('div#sign_page').hide(1000,function(){});
			jQuery('div#login_page').show(1000,function(){});
		});
		jQuery('button#fb_login').on("touchend", function()
		{
			alert('Functionality Maybe Added');
		});
		jQuery('button#g_login').on("touchend", function()
		{
			alert('Functionality Maybe Added');
		});
		jQuery('div.foot').on("touchend", function(event)
		{
			alert('Designed and Connected By Sanchit Dang (1410992149)');
			alert('Database Handled By Navneet Khatkar (1410992136)');
			alert('Documented By Puneet Bali (1410992195)');
			event.stopPropagation();
		});
	jQuery('input').on('focus',function(){jQuery('.foot').hide();});	
	jQuery('input').on('blur',function(){jQuery('.foot').show();});
	jQuery('#menu_button1').on('touchend',function(){
		jQuery('.foot_main').hide();
		jQuery('#nav_buttons').hide();
		retrive_menu_info();
		jQuery('#menu_card').show();
	});
	jQuery('.head_main').on('touchend',function(){
	load_mainui();
	});
	jQuery('#menu_button2').on('click touchend',function(){
		jQuery('.foot_main').hide();
		jQuery('#nav_buttons').hide();
		suggestion();
		jQuery('#menu_card').show();
	});
	jQuery('#menu_button3').on('click touchend',function(){
		jQuery('.foot_main').hide();
		jQuery('#nav_buttons').hide();
		complaint();
	});
	var Global_username="";
	function login_fun(data,username){
		if(data=="T")
		{
			Global_username=username;
			load_mainui();
			var XYZ="Uname="+username;
			jQuery('#name_display_foot').text('Welcome! '+usersname(username));
		}else if(data=="F"){alert("Incorrect Username/Passord");}
	}
	function complaint()
	{
		jQuery('#main_foot_li_About_US').hide();
		jQuery('#menu_card').html('');
		jQuery('#menu_card').hide();
		jQuery('#feedbackUI').html("<table name='complaint' class='feedback_ui_button_space' cellpadding='10%'><tr><td class='feedback_buttons_td'>Name</td><td class='feedback_buttons_td' ><strong>"+usersname(Global_username)+"</strong></td></tr><tr><td class='feedback_buttons_td'>Complaint</td><td class='feedback_buttons_td suggestion'><textarea class='materialize-textarea' id='complaint'></textarea></td></tr><tr><td class='feedback_buttons_td' colspan='2' id='Csubmit'><center>Submit</center></td></tr></table>");
		jQuery('#Csubmit').on('click',function(){
								if((jQuery('#complaint').val()==""))
								{alert("Oh! No Complaints :)");}
								else{
								var complaint_final="username="+Global_username+"&complaint="+jQuery('#complaint').val();
								jQuery.ajax({
								type: "POST",
								url: 'http://www.squareonefeedback.com/Scripts/complaint.php',
								data: complaint_final,
								crossDomain: true,
								cache: false,
								success: function(dataS){
								alert(dataS);}
								});
								}
							});
	}
	function suggestion()
	{
		jQuery('#main_foot_li_About_US').hide();
		jQuery('#menu_card').html('');
		jQuery('#menu_card').hide();
		jQuery('#feedbackUI').html("<table name='suggestion' class='feedback_ui_button_space' cellpadding='10%'><tr><td class='feedback_buttons_td'>Name</td><td class='feedback_buttons_td' ><strong>"+usersname(Global_username)+"</strong></td></tr><tr><td class='feedback_buttons_td'>Suggestion</td><td class='feedback_buttons_td suggestion'><textarea class='materialize-textarea' id='suggestion'></textarea></td></tr><tr><td class='feedback_buttons_td' colspan='2' id='Ssubmit'><center>Submit</center></td></tr></table>");
		jQuery('#Ssubmit').on('touchend',function(){
								if((jQuery('#suggestion').val()==""))
								{alert("Please Enter a suggestion");}
								else{
								var suggestion_final="username="+Global_username+"&suggestion="+jQuery('#suggestion').val();
								jQuery.ajax({
								type: "POST",
								url: 'http://www.squareonefeedback.com/Scripts/suggestion.php',
								data: suggestion_final,
								crossDomain: true,
								cache: false,
								success: function(dataS){
								alert(dataS);}
								});
								}
							});
	}
	function retrive_menu_info()
	{	
		jQuery('#main_foot_li_About_US').hide();
		jQuery('#menu_card').html('');
		jQuery.getJSON("http://squareonefeedback.com/Scripts/menu_retrieve.php",function(result){
			jQuery('#menu_card').html('');
			jQuery.each(result, function(i, field){
			jQuery('#menu_card').append("<div class='card horizontal'><div class='card-image'><img src='img/food/"+field.item_id+".jpg'></div><div class='card-stacked'><div class='card-content'><a name='item_name_menu_card'><strong>"+field.item_name+"</strong><br>Price:"+field.price+"</a></div><div class='card-action'><a name='"+field.item_id+"' class='givefeedback'>Give Feedback</a></div></div></div>");
			});
			jQuery('.givefeedback').on('touchend',function(event){
					var item_id=jQuery(this).attr('name');
					var itemID="item_id="+item_id;
					jQuery('#menu_card').hide();
					jQuery.ajax({
						type: "POST",
						url:'http://www.squareonefeedback.com/Scripts/item_detail_retrieve.php',
						data: itemID,
						crossDomain: true,
						cache: false,
						success: function(dataX)
						{
							var i=0;
							var temp=[];
							for(i=1;i<dataX.length-1;i++)
							{
							temp[i-1]=dataX[i];
							}		  			
							var tempX=temp.join('');
							var new_obj=JSON.parse(tempX);
							jQuery('#feedbackUI').html("<table name='"+(new_obj.item_id)+"' class='feedback_ui_button_space' cellpadding='10%'><tr><td class='feedback_buttons_td'>Name</td><td class='feedback_buttons_td' >"+(new_obj.item_name)+"</td></tr><tr><td class='feedback_buttons_td'>Rate the Item</td><td class='feedback_buttons_td'><div input-field><select id='RFeedback'><option value='' disabled selected>Choose your option</option><option value='3'>Excellent</option><option value='2'>Average</option><option value='1'>Bad</option></select></div></td></tr><tr><td class='feedback_buttons_td'>Comment</td><td class='feedback_buttons_td comment'><textarea class='materialize-textarea' id='comment'></textarea></td></tr><tr><td class='feedback_buttons_td' colspan='2' id='Fsubmit'><center>Submit</center></td></tr></table>");
							jQuery('#Fsubmit').on('touchend',function(){
								if((jQuery('#RFeedback').val()==null))
								{alert("Please Select A Rating");}
								else{
								var fBack_final="item_id="+jQuery('.feedback_ui_button_space').attr('name')+"&username="+Global_username+"&comment="+jQuery('#comment').val()+"&rating="+jQuery('#RFeedback').val();
								jQuery.ajax({
								type: "POST",
								url: 'http://www.squareonefeedback.com/Scripts/give_feedback.php',
								data: fBack_final,
								crossDomain: true,
								cache: false,
								success: function(dataY){
								alert(dataY);
								load_comm(item_id);}
								});
								}
							});
						load_comm(item_id);}
						});
					event.preventDefault();
			});
     		}); 
	}
	function load_comm(item_id)
	{
		jQuery("div#FEEDBACKMAIN").html("");
		var dataITEM="item_id="+item_id;
		jQuery.post("http://www.squareonefeedback.com/Scripts/take_feedback.php",dataITEM,function(feedback_R){		
			jQuery.each(feedback_R,function(i,temp_feedback_R){
				if(temp_feedback_R.comment=="")
				jQuery("div#FEEDBACKMAIN").append("<table class='feedback_return_button_space' cellpadding='15%'><tr><th style'align:left;' colspan='2' class='feedback_buttons_td'>User : "+usersname(temp_feedback_R.username)+"</th></tr><tr><td class='feedback_buttons_td'>Rated:</td><td class='feedback_buttons_td'>"+RATING(temp_feedback_R.rating)+"</td></tr><br><br></table>");
				else
				jQuery("div#FEEDBACKMAIN").append("<table class='feedback_return_button_space' cellpadding='15%'><tr><th style'align:left;' colspan='2' class='feedback_buttons_td'>User : "+usersname(temp_feedback_R.username)+"</th></tr><tr><td class='feedback_buttons_td'>Rated:</td><td class='feedback_buttons_td'>"+RATING(temp_feedback_R.rating)+"</td></tr><tr><td class='feedback_buttons_td'>Commented:</td><td class='feedback_buttons_td comment'>"+temp_feedback_R.comment+"</td></tr><br><br></table>");
			});
		},'json');
	}
	function RATING(rate)
	{
		switch(rate)
		{
		case '1':return "Bad";
		case '2':return "Average";
		case '3':return "Excellent";
		default:return "Nothing";
		}
	}
	function usersname(uname)
	{
	var temp_name='';
	var XYZ="Uname="+uname;
		jQuery.ajax({
				type: "POST",
				url:"http://www.squareonefeedback.com/Scripts/R_Fname.php",
				data: XYZ,
				crossDomain: true,
				cache: false,
				async: false,
				success: function(dataZ)
				{	
					temp_name=dataZ;
					
				},
				failure:function(){}
			});
			if(temp_name!=undefined&&temp_name!="")
		return temp_name;
		
	}
	function initial()
	{
	jQuery('div#login_page').hide();
	jQuery('div#sign_page').hide();
	jQuery('div#X_ALERT').hide();
	jQuery('.head_main').hide();
	jQuery('#main_ui').hide();
	jQuery('#foot_main').hide();
	jQuery('#menu_card').hide();
	jQuery('#nav_buttons').hide();
	jQuery('#foot_buttons').hide();
	}
	function load_mainui(){
	jQuery('#feedbackUI').html("");
	jQuery('div#FEEDBACKMAIN').html("");
	jQuery('.head_main').show();
	jQuery('.foot').hide();
	jQuery('#main_ui').show();
	jQuery('#menu_card').hide();
	jQuery('div#login_page').hide();
	jQuery('body').css('background' , ' #000 url(img/main_ui.png) repeat center');
	jQuery('.foot').hide(100,function(){});
	jQuery('.foot_main').show(100,function(){});
	jQuery('#nav_buttons').show();
	jQuery('#foot_buttons').show();
	counter_back++;
	}
	
	</script>
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript">
	var counter_back=0;
	document.addEventListener("backbutton", onBackKeyDown, false);
	function onBackKeyDown(eventXX) {
		if(counter_back==0)
		{eventXX.preventDefault();}
		if(counter_back>0)
		{load_mainui();}
		}
        app.initialize();
		initial();

    </script>
</body>
</html>
